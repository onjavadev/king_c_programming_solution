# Предисловие

> В вычислительной технике превращение очевидного в полезное - это живое определение слова "фрустрация".
> 

За годы, прошедшие с момента выхода первого издания книги "Программирование на языке Си: Современный подход" появилось множество новых языков, основанных на Си, - в первую очередь, Java и C#, - а родственные языки, такие как C++ и Perl, достигли большей известности. Тем не менее, язык Си остается таким же популярным, как и прежде, работая в фоновом режиме и тихо питая большую часть мирового программного обеспечения. Он остается *lingua franca* компьютерной вселенной, как и в 1996 году.
Но даже Си должен меняться в ногу со временем. Необходимость в новом издании книги "Программирование на языке Си: Современный подход" стала очевидной после выхода в свет стандарта *C99*. Более того, первое издание, с его ссылками на DOS и 16-битные процессоры, уже устарело. Второе издание полностью соответствует современным требованиям и улучшено во многих других отношениях.

# Что нового во втором издании?

Вот список новых возможностей и улучшений во втором издании:

- **Полное покрытие стандарта *C89* и стандарта *C99*.** Самым большим различием между первым и вторым изданиями является охват стандарта C99. Моей целью было охватить все существенные различия между C89 и C99, включая все возможности языка и библиотечные функции, добавленные в C99. Каждое изменение в C99 четко обозначено, либо заголовком раздела "C99", либо, в случае более коротких обсуждений, - специальным значком на левом поле. Я сделал это отчасти для привлечения внимания к изменениям, а отчасти для того, чтобы читатели, не интересующиеся C99 или не имеющие доступа к компилятору C99, знали, что следует пропустить. Многие из дополнений C99 представляют интерес только для специализированной аудитории, но некоторые из новых возможностей будут полезны почти всем программистам на Си.
- **Включает краткое руководство по всем библиотечным функциям C89 и C99.** Приложение В первом издании описывались только стандартные библиотечные функции C89. В этом издании приложение охватывает все библиотечные функции C89 и C99.
- **Расширенное освещение GCC.** За годы, прошедшие с момента выхода первого издания, использование GCC (первоначально GNU C Compiler, теперь GNU Compiler Collection) получило широкое распространение. GCC имеет некоторые значительные преимущества, включая высокое качество, низкую (т.е. никакую) стоимость и переносимость на различные аппаратные и программные платформы. Признавая его растущую важность, я включил в это издание больше информации о GCC, в том числе обсуждение того, как его использовать, а также распространенных сообщений об ошибках и предупреждений GCC.
- **Новое освещение абстрактных типов данных.** В первом издании значительная часть главы 19 была посвящена C++. Сегодня этот материал кажется менее актуальным, поскольку студенты, возможно, уже изучили C++, Java или C# до прочтения этой книги. В этом издании освещение C++ было заменено обсуждением того, как объявлять абстрактные типы данных ни Си.
- **Расширенное освещение международных возможностей**. Глава 25, посвященная международным возможностям языка Си, стала намного длиннее и подробнее. Информация о наборе символов Unicode/UCS и их кодировках является изюминкой расширенного освещения.
- **Обновлено с учетом современных процессоров и операционных систем**. Когда я писал первое издание, 16-разрядные архитектуры и операционная система DOS все еще были актуальны для многих читателей, но сегодня это уже не так. Я обновил обсуждение, чтобы больше сосредоточиться на 32-битных и 64-битных архитектурах. Развитие Linux и других версий UNIX обусловило больший акцент на этом семействе операционных систем, хотя аспекты Windows и операционной системы Mac OS, влияющие на программистов на языке Си, также упоминаются.
- **Больше упражнений и проектов по программированию**. Первое издание этой книги содержало 31 упражнение. В этом издании их почти 500 (498, если быть точным), разделенных на две группы: упражнения и проекты по программированию.
- **Ответы на отдельные упражнения и проекты по программированию**. Наиболее частой просьбой, которую я получал от читателей первого издания, была просьба дать ответы на упражнения. В ответ на эту просьбу я разместил ответы примерно на треть упражнений и проектов по программированию в Интернете на сайте. Эта возможность особенно полезна для читателей, которые не учатся на курсах в колледже и нуждаются в возможности проверить свою работу. Упражнения и проекты, к которым даны ответы, отмечены значком W (W* означает "ответ доступен в Интернете").
    
    [C Programming: A Modern Approach - Second Edition](http://knking.com/books/c2/)
    
- **Сайт преподавателя, защищенный паролем**. Для этого издания я создал новый сайт ресурсов для преподавателей (доступ к нему осуществляется через [knking.com/books/c2](http://knking.com/books/c2)), содержащий решения оставшихся упражнений и проектов, а также презентации PowerPoint для большинства глав. Преподаватели могут связаться со мной по адресу [chook@knking.com](mailto:chook@knking.com) для получения пароля. Пожалуйста, используйте адрес электронной почты вашего кампуса и укажите ссылку на сайт вашего факультета, чтобы я мог проверить вашу личность.

Я также воспользовался возможностью улучшить формулировки и пояснения во всей книге. Изменения масштабны и кропотливы: каждое предложение было проверено и при необходимости переписано.
Хотя в этом издании многое изменилось, я постарался максимально сохранить первоначальную нумерацию глав и разделов. Только одна глава (последняя) является полностью новой, но многие главы содержат дополнительные разделы. В некоторых случаях нумерация существующих разделов была изменена. Одно приложение (синтаксис языка C) было исключено, но добавлено новое приложение, в котором сравниваются C99 и C89.

# Цели

Цели этого издания остаются теми же, что и у первого издания:

- **Быть понятным, читабельным и, возможно, даже увлекательным**. Многие книги по С слишком лаконичны для среднего читателя. Другие плохо написаны или просто скучны. Я постарался дать четкие, подробные объяснения, сдобренные достаточным количеством юмора, чтобы заинтересовать читателя.
- **Быть доступным для широкого круга читателей**. Я предполагаю, что у читателя есть хотя бы небольшой опыт программирования, но не предполагаю знания какого-то конкретного языка. Я старался свести жаргон к минимуму и дать определение терминам, которые я использую. Я также попытался отделить продвинутый материал от более элементарных тем, чтобы начинающий не был обескуражен.
- **Быть авторитетным без педантизма**. Чтобы избежать произвольного решения о том, что включать, а что нет, я постарался охватить все возможности языка и библиотеки Си. В то же время я старался не перегружать читателя излишними подробностями.
- **Быть организованным для удобства обучения**. Мой опыт преподавания языка Си подчеркивает важность постепенного представления возможностей языка Си. Я использую спиральный подход, при котором трудные темы вводятся кратко, а затем повторяются один или несколько раз в книге, причем каждый раз добавляются новые подробности. Темп изложения продуман, каждая глава постепенно развивается на основе предыдущей. Для большинства студентов это, вероятно, лучший подход: он позволяет избежать крайностей, таких как скука, с одной стороны, или "информационная перегрузка", с другой.
- **Мотивировать в изучении особенностей языка**. Вместо того чтобы просто описывать каждую особенность языка и приводить несколько простых примеров использования этой особенности, я попытался мотивировать каждую особенность и обсудить, как она используется в практических ситуациях.
- **Подчеркивать стиль**. Для каждого программиста на языке Си важно выработать свой стиль. Однако вместо того, чтобы диктовать, каким должен быть этот стиль, я обычно описываю несколько вариантов и предоставляю читателю выбрать наиболее привлекательный. Знание альтернативных стилей очень помогает при чтении чужих программ (на что программисты часто тратят много времени).
- **Избегать зависимости от конкретной машины, компилятора или операционной системы**. Поскольку язык C доступен на таком широком спектре платформ, я старался избежать зависимости от конкретной машины, компилятора или операционной системы. Программы Al разработаны таким образом, чтобы их можно было переносить на самые разные платформы.
- **Использовать иллюстрации для разъяснения ключевых понятий**. Я старался поместить как можно больше рисунков, поскольку считаю, что они очень важны для понимания многих аспектов языка С. В частности, я старался "оживить" алгоритмы, когда это возможно, показывая
снимки данных на разных этапах вычислений.

# Что такого современного в современном подходе?

Одной из моих самых важных целей было применение "современного подхода" к С. Вот некоторые из способов, которыми я пытался достичь этой цели:

- **Поставьте C в перспективу**. Вместо того чтобы рассматривать Си как единственный язык программирования, который стоит знать, я рассматриваю его как один из многих полезных языков. Я обсуждаю, для каких приложений Си лучше всего подходит; я также показываю, как использовать сильные стороны Си, минимизируя его слабые стороны.
- **Подчеркивайте стандартные версии языка C**. Я уделяю минимум внимания версиям языка, предшествующим стандарту C89. Есть лишь несколько разрозненных ссылок на K&R C (версия языка 1978 года, описанная в первом издании книги Брайана Кернигана и Денниса Ричи "Язык программирования C"). В приложении C перечислены основные различия между C89 и K&R C.
- **Развенчивайте мифы**. Современные компиляторы часто противоречат общепринятым представлениям о Си. Я не стесняюсь развенчивать некоторые мифы о Си или оспаривать убеждения, которые давно стали частью фольклора Си (например, убеждение, что арифметика с указателями всегда быстрее, чем индексация массивов). Я пересмотрел старые соглашения языка Си, сохранив те, которые по-прежнему полезны.
- **Упор на программную инженерию**. Я рассматриваю C как зрелый инструмент программной инженерии, подчеркивая, как использовать его для решения проблем, возникающих в процессе разработки программ. Я подчеркиваю, что программы должны быть читаемыми, сопровождаемыми, надежными и переносимыми, и уделяю особое внимание сокрытию информации.
- **Отложите низкоуровневые функции языка Си**. Эти возможности, хотя и удобны для системного программирования, которое изначально выполнялось на Си, не так актуальны сейчас, когда Си используется для большого разнообразия приложений. Вместо того чтобы представлять их в первых главах, как это делают многие книги по Си, я откладываю их до главы 20.
- **Уменьшите акцент на "ручной оптимизации"**. Многие книги учат читателя писать хитрый код, чтобы получить небольшую экономию на эффективности программы. При сегодняшнем изобилии оптимизирующих компиляторов языка Си эти приемы зачастую уже не нужны; более того, они могут привести к тому, что программы станут менее эффективными.

# Q&A секции

Каждая глава заканчивается разделом "O&A" - серией вопросов и ответов, связанных с материалом, рассмотренным в данной главе. В этих разделах рассматриваются такие темы, как:

- **Часто задаваемые вопросы**. Я постарался ответить на вопросы, которые часто возникают в моих собственных курсах, в других книгах и в группах новостей, связанных с языком C.
- **Дополнительное обсуждение и разъяснение сложных вопросов**. Хотя читатели с опытом работы с различными языками могут быть удовлетворены кратким объяснением и парой примеров, читателям с меньшим опытом нужно больше.
- **"Побочные" вопросы, не относящиеся к основному потоку**. Некоторые вопросы затрагивают технические проблемы, которые будут интересны не всем читателям.
- **Слишком сложный или эзотерический материал, чтобы заинтересовать среднего читателя**. Вопросы такого рода помечены звездочкой (*). Любознательные читатели с достаточным
опыт в программировании, возможно, захотят сразу же углубиться в эти вопросы; остальным лучше пропустить их при первом прочтении. Предупреждение: Эти вопросы часто относятся к темам, рассматриваемым в последующих главах.
- **Общие различия между компиляторами Си**. Я обсуждаю некоторые часто используемые (но нестандартные) возможности, предоставляемые конкретными компиляторами.

Некоторые вопросы в разделах "Вопросы и ответы" относятся непосредственно к определенным местам главы; эти места отмечены специальным значком, сигнализирующим читателю о наличии дополнительной информации.

# Другие особенности

В дополнение к разделам вопросов и ответов я включил ряд полезных функций, многие из которых отмечены простыми, но характерными значками (показаны слева).

- Предупреждения предостерегают читателей от распространенных ловушек. Язык C славится своими ловушками; документировать их все - безнадежная, но не невозможная задача. Я постарался отобрать наиболее распространенные и/или важные подводные камни.
- Перекрестные ссылки обеспечивают возможность поиска информации с помощью гипертекста. Хотя многие из них являются указателями на темы, рассматриваемые далее в книге, некоторые указывают на предыдущие темы, которые читатель может захотеть просмотреть.
- Идиомы - шаблоны кода, часто встречающиеся в программах на языке Си - помечены для быстрого поиска.
- Советы по переносимости дают подсказки для написания программ, которые не зависят от конкретной машины, компилятора или операционной системы.
- В боковых колонках рассматриваются темы, которые не являются частью языка Си, но которые должен знать каждый программист. (Пример боковой панели см. в разделе "Исходный код" на следующей странице).
- Приложения содержат ценную справочную информацию.

# Программы

Выбор иллюстративных программ - непростая задача. Если программы будут слишком краткими и искусственными, читатели не смогут понять, как эти функции используются в реальном мире. С другой стороны, если программа слишком реалистична, ее суть легко потерять в лесу деталей. Я выбрал средний путь, используя небольшие, простые примеры, чтобы сделать понятия понятными при первом знакомстве с ними, затем постепенно довести их до законченных программ. Я не включил в книгу программы большого объема; по моему опыту, у преподавателей не хватает времени на их изучение, а у студентов не хватает терпения их читать. Я не игнорирую вопросы, возникающие при создании больших программ, хотя глава 15 (Написание больших программ) и глава 19 (Проектирование программ) подробно освещают их.

Я удержался от желания переписать программы, чтобы воспользоваться возможностями C99, поскольку не каждый читатель может иметь доступ к компилятору C99 или захотеть использовать C99. Тем не менее, я использовал заголовок `<stdbool. h>` из C99 в нескольких программах, поскольку он удобно определяет макросы с именами `bool`, `true` и `false`. Если ваш компилятор не поддерживает заголовок `<stdbool. h>`, вам придется дать собственные определения для этих имен.
Программы в этом издании претерпели одно очень незначительное изменение. Функция `main` теперь имеет вид `int main (void) { ... }` в большинстве случаев. Это изменение отражает рекомендуемую практику и совместимо с C99, который требует явного типа возврата для каждой функции.

> Исходный код всех программ доступен на сайте [knking.com/books/c2](http://knking.com/books/c2). Обновления, исправления и новости о книге также можно найти на этом сайте.
> 

# Аудитория

Эта книга предназначена в качестве основного текста для курса по языку Си на уровне бакалавриата. Предыдущий опыт программирования на языке высокого уровня или ассемблере полезен, но не обязателен для компьютерно грамотного читателя ("опытного новичка", как выразился один из моих бывших редакторов).
Поскольку книга самодостаточна и может быть использована как для справки, так и для обучения, она является прекрасным дополнением к книге.
Поскольку книга самодостаточна и может использоваться как для справки, так и для обучения, она станет отличным сопутствующим текстом для курса по структурам данных, проектированию компиляторов, операционным системам, компьютерной графике, встроенным системам или другим курсам, в которых язык Си используется для проектной работы. Благодаря разделам с вопросами и ответами и акценту на практических проблемах, книга также понравится читателям, которые посещают учебные курсы или изучают Си самостоятельно.

# Структура

Книга состоит из четырех частей:

- **Основные возможности языка C**. Главы 1-10 охватывают достаточно материала по языку C, чтобы читатель мог писать однофайловые программы с использованием массивов и функций.
- **Расширенные возможности языка C**. Главы 11-20 основываются на материале предыдущих глав. В этих главах темы немного усложняются, в них подробно рассматриваются указатели, строки, препроцессор, структуры, объединения, перечисления и низкоуровневые возможности языка C. Кроме того, в двух главах (15 и 19) даются рекомендации по разработке программ.
- **Стандартная библиотека Си**. Главы 21-27 посвящены библиотеке языка Си - большому набору функций, который поставляется с каждым компилятором. Эти главы, скорее всего, будут использоваться как справочный материал, хотя некоторые из них подходят для лекций.
- **Справочник**. В Приложении А приведен полный список операторов языка Си. Приложение B описывает основные различия между C99 и C89, а Приложение C - различия между C89 и K&R C. Приложение D представляет собой алфавитный список функций стандартных библиотек C89 и C99 с подробным описанием каждой. В приложении El перечислен набор символов ASCI. Аннотированная библиография указывает читателю на другие источники информации.

Полноценный курс по языку Си должен последовательно охватывать главы 1-20, при необходимости добавляя темы из глав 21-27. (Глава 2, в которой рассматривается ввод/вывод файлов, является самой важной из этой группы). В более коротком курсе можно опустить следующие темы без потери преемственности: Раздел 8.3 (массивы переменной длины), Раздел 9.6 (рекурсия), Раздел 12.4 (указатели и многомерные массивы). Раздел 12.5 (указатели и массивы переменной длины), раздел 14.5 (различные направления), раздел 17.7 (указатели на функции), раздел 17.8 (ограниченные указатели), раздел 17.9 (гибкие члены массива), раздел 18.6 (встроенные функции), глава 19 (проектирование программ), раздел 20.2 (битовые поля и структуры) и раздел 20.3 (другие низкоуровневые методы).

# Упражнения и проекты по программированию

Наличие разнообразных хороших задач, безусловно, необходимо для учебника. Данное издание книги содержит как упражнения (короткие задачи, не требующие написания полной программы), так и проекты по программированию (задачи, требующие написания или модификации целой программы).
Несколько упражнений имеют неочевидные ответы (некоторые недоброжелатели называют их "вопросами с подвохом"). Поскольку программы на языке Си часто содержат множество примеров такого кода, я считаю необходимым предоставить некоторую практику. Однако я буду вести честную игру, помечая эти упражнения звездочкой (*). Будьте осторожны с упражнениями, отмеченными звездочкой: либо будьте внимательны и хорошо подумайте, либо пропустите их совсем.

# Ошибки, отсутствие (?)

Я приложил все усилия, чтобы обеспечить точность этой книги. Однако неизбежно, что в любой книге такого размера есть несколько ошибок. Если вы заметили одну из них, пожалуйста, свяжитесь со мной по адресу [cbook@knking.com](mailto:cbook@knking.com). Я также буду признателен за информацию о том, какие функции показались вам особенно полезными, без каких вы могли бы обойтись, и что вы хотели бы добавить.